(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{25823:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var r=n(85893),a=n(67294),o=n(809),s=n.n(o),i=n(59999),c=n(26265),u=n(64121),l=n(92447),d=n(41120),m=n(7858),p=n(14016),f=n(81273),h=n(51709),g=n(636),x=n(79302),b=(0,d.Z)((function(e){return{eachCommentContainer:{display:"flex",marginBottom:10,border:"1px solid #bfbfbf",minHeight:150},eachComment:{position:"relative",width:"100%"},editButtons:{marginBottom:10,marginTop:10},edit:{background:"teal",padding:4,color:"white",marginRight:4,borderRadius:10,"&:hover":{cursor:"pointer"}},delete:{background:"#800000",padding:4,color:"white",borderRadius:10,"&:hover":{cursor:"pointer"}},voteUp:{width:36,height:36,padding:2,"&:hover":{transform:"scale(1.3,1.3)"}},voteContainer:{display:"flex",flexDirection:"column",justifyContent:"center",background:"#FAF8F9",textAlign:"center",marginRight:10},bookmark:{height:20,width:20,marginRight:10,"&:hover":{transform:"scale(1.3,1.3)"},position:"absolute",right:10},text:{marginTop:10},deleteContainer:{display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",background:e.palette.primary.light,color:"#fff",borderRadius:4,padding:8,margin:10}}})),v=function(e){return e>999999?Math.abs(e)>999999?(Math.abs(e)/1e6).toFixed(1)+"m":Math.abs(e):Math.abs(e)>999?(Math.abs(e)/1e3).toFixed(1)+"k":Math.abs(e)},k=function(e){var t=b(),n=e.text,o=e.hasVoted,i=e.isOwner,c=e.hasBookmarked,d=e.votes_count,k=e.id,y=e.paper,w=(0,a.useState)(c),j=w[0],C=w[1],S=(0,a.useState)(o),Z=S[0],O=S[1],N=(0,a.useState)(d),M=N[0],B=N[1],E=(0,a.useState)(!1),F=E[0],T=E[1],D=(0,a.useState)(n),R=D[0],P=D[1],A=(0,a.useState)("edit"),_=A[0],L=A[1],H=(0,a.useState)(!1),$=H[0],q=H[1],K=(0,a.useContext)(x.UserContext),I=K.state,U=K.dispatch,V=function(){var e=(0,l.Z)(s().mark((function e(){var t,n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I.loginStatus){e.next=3;break}return U({type:"toggleModal",show:!0}),e.abrupt("return");case 3:return t=(y?m.q$:m.OK)+k+"/",e.next=6,(0,p.aH)(t,{vote:"vote"});case 6:n=e.sent,r=(0,u.Z)(n,2),a=r[0],r[1],O(a.hasVoted),C(a.hasBookmarked),B(a.votes_count);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=(0,l.Z)(s().mark((function e(){var t,n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I.loginStatus){e.next=3;break}return U({type:"toggleModal",show:!0}),e.abrupt("return");case 3:return t=(y?m.q$:m.OK)+k+"/",e.next=6,(0,p.aH)(t,{bookmark:"bookmark"});case 6:n=e.sent,r=(0,u.Z)(n,2),a=r[0],r[1],O(a.hasVoted),C(a.hasBookmarked);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=(0,l.Z)(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I.loginStatus){e.next=3;break}return U({type:"toggleModal",show:!0}),e.abrupt("return");case 3:return t=y?m.q$+"".concat(k,"/"):m.OK+"".concat(k,"/"),e.next=6,(0,p.R2)(t);case 6:n=e.sent,r=(0,u.Z)(n,2),r[0],r[1]||q(!0),T(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return $?(0,r.jsx)("div",{className:t.deleteContainer,children:"This comment has been deleted"}):(0,r.jsxs)("div",{className:t.eachCommentContainer,children:[(0,r.jsxs)("div",{className:t.voteContainer,children:[(0,r.jsx)("img",{alt:"",src:Z?"/upDone.svg":"/up.svg",className:t.voteUp,onClick:V}),(0,r.jsx)("div",{children:v(M)})]}),(0,r.jsxs)("div",{className:t.eachComment,children:[(0,r.jsxs)("div",{className:t.editButtons,children:[(0,r.jsx)("img",{src:j?"/bookmarked.svg":"/bookmark.svg",alt:"",className:t.bookmark,onClick:z}),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:t.edit,onClick:function(){I.loginStatus?(L("edit"),T(!0)):U({type:"toggleModal",show:!0})},children:"edit"}),(0,r.jsx)("span",{className:t.delete,onClick:function(){I.loginStatus?(L("delete"),T(!0)):U({type:"toggleModal",show:!0})},children:"delete"})]})]}),(0,r.jsx)("div",{className:"renderHTML ".concat(t.text),dangerouslySetInnerHTML:{__html:R}})]}),(0,r.jsx)(f.Z,{show:F,setShow:function(e){T(e)},children:"edit"===_?(0,r.jsx)(h.Z,{onSuccess:function(e){P(e.text),T(!1)},data:e,paperComment:y}):(0,r.jsx)(g.Z,{title:"comment",onDelete:W})})]},k)},y=n(66061),w=n(58533),j=n(23849);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=(0,d.Z)((function(e){return{main:{marginTop:40},container:{display:"flex",flexDirection:"column",marginRight:"auto",marginLeft:"auto",width:"100%",justifyContent:"center"},commentContainer:{display:"flex",flexDirection:"column"},label:{fontSize:20,textAlign:"center",marginBottom:20,fontWeight:"bolder"},noCommentLabel:{margin:10,textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",padding:10,fontSize:20,fontStyle:"italic"}}})),O=function(e){var t=e.comments,n=e.paper,o=Z(),c=(0,a.useState)(t),d=c[0],m=c[1];(0,a.useEffect)((function(){t&&m(t)}),[t]);var f=function(){var e=(0,l.Z)(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.links.next){e.next=8;break}return e.next=3,(0,p.XD)(d.links.next);case 3:t=e.sent,n=(0,u.Z)(t,2),r=n[0],n[1],(0,j.xb)(r)||m(S(S({},r),{},{results:[].concat((0,i.Z)(d.results),(0,i.Z)(r.results))}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.jsxs)("div",{className:o.container,children:[(0,r.jsx)("div",{className:o.label,children:"COMMENTS"}),0===d.results.length&&(0,r.jsx)("div",{className:o.noCommentLabel,children:"No comments found."}),(0,r.jsx)(w.Z,{dataLength:d.results.length||0,next:f,hasMore:Boolean(d.links.next)||!1,loader:(0,r.jsx)(y.Z,{}),children:d.results.map((function(e){return(0,a.createElement)(k,S(S({},e),{},{key:e.id,paper:n}))}))})]})}},51709:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var r=n(85893),a=n(809),o=n.n(a),s=n(64121),i=n(92447),c=n(67294),u=n(89265),l=n.n(u),d=n(41120),m=n(37163),p=n(91559),f=n(282),h=n(14016),g=n(7858),x=n(66061),b=n(79302),v=(0,d.Z)((function(e){return{container:{},button:{marginBottom:20,background:"teal",color:"white","&:hover":{background:"black"}},editor:{border:"10px solid #FAF8F9"},commentButton:{marginTop:10,background:"teal",color:"white","&:hover":{background:"black"}}}})),k=function(e){var t=e.onSuccess,n=e.feedId,a=e.data,u=e.paperComment,d=(0,c.useState)(m.EditorState.createEmpty()),k=d[0],y=d[1],w=(0,c.useState)(!1),j=w[0],C=w[1],S=(0,c.useState)(!1),Z=S[0],O=S[1],N=v(),M=(0,c.useContext)(b.UserContext),B=M.state,E=M.dispatch;(0,c.useEffect)((function(){if(a&&a.id){var e=a.text,t=(0,m.convertFromHTML)(e),n=m.ContentState.createFromBlockArray(t.contentBlocks,t.entityMap);y(m.EditorState.createWithContent(n))}}),[a]);var F=function(){var e=(0,i.Z)(o().mark((function e(){var r,i,c,d,p,f,x,b,v,w;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B.loginStatus){e.next=3;break}return E({type:"toggleModal",show:!0}),e.abrupt("return");case 3:if(O(!0),r=(0,m.convertToRaw)(k.getCurrentContent()),i=l()(r),!a||!a.id){e.next=17;break}return c=u?g.q$+"".concat(a.id,"/"):g.OK+"".concat(a.id,"/"),e.next=10,(0,h.JY)(c,{text:i});case 10:d=e.sent,p=(0,s.Z)(d,2),f=p[0],p[1]||t(f),e.next=27;break;case 17:if(!n){e.next=27;break}return x=u?g.q$+"?paper=".concat(n):g.OK+"?feed=".concat(n),e.next=21,(0,h.uV)(x,{text:i});case 21:b=e.sent,v=(0,s.Z)(b,2),w=v[0],v[1],t(w),y(m.EditorState.createEmpty());case 27:O(!1);case 28:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.jsx)("div",{className:N.container,children:a&&a.id||j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:N.editor,children:(0,r.jsx)(p.Z,{onEditorStateChange:function(e){y(e)},editorState:k,uploadCallback:function(e){return new Promise(function(){var t=(0,i.Z)(o().mark((function t(n,r){var a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(B.loginStatus){t.next=5;break}E({type:"toggleModal",show:!0}),r("error"),t.next=8;break;case 5:return a=function(){var e=(0,i.Z)(o().mark((function e(t){var r,a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("image",t),e.next=4,(0,h.Ru)(g.f$,r,{"content-type":"multipart/form-data"});case 4:a=e.sent,i=(0,s.Z)(a,2),c=i[0],i[1]||n({data:{link:g.vO+c.src}});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.next=8,a(e);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())},placeholder:"Type a comment",disabled:Z})}),Z?(0,r.jsx)(x.Z,{}):(0,r.jsx)(f.Z,{className:N.commentButton,size:"large",disabled:!k.getCurrentContent().hasText(),onClick:function(){F()},children:"Comment"})]}):(0,r.jsx)(f.Z,{className:N.button,color:"secondary",onClick:function(){return C(!0)},disabled:Z,children:"Add Comment"})})}}}]);